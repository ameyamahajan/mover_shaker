<!DOCTYPE html>
<html>
  <head>
    <link href="/static/css/style.css" rel="stylesheet">
      {% block script %}
    <script src="http://code.jquery.com/jquery-2.0.3.min.js"></script>
    <script type="text/javascript">

      $(document).ready(function(){
          $("#upload-file").click(function(e){
            var fileSelect = document.getElementById("input-file");
            var formData = new FormData();
            var file = fileSelect.files[0];
            formData.append('contents', file);
            var xhr = new XMLHttpRequest();
            xhr.open('POST', '/upload', true);
            xhr.addEventListener("progress", updateProgress);
            xhr.addEventListener("load", transferComplete);
            xhr.onreadystatechange = function(){
              if (xhr.readyState == 4 && xhr.status == 200){
                  document.getElementById("test").innerHTML = xhr.responseText;
              }
            }
            xhr.send(formData);
            e.preventDefault();
        })


        function transferComplete(e) {
            console.log("The transfer is complete.");
            alert("Upload Completed");
            document.getElementById("rest").innerHTML =  'Uploaded successfully!'
          };
        function updateProgress(evt) {
              console.log("In progress");
              document.getElementById("rest").innerHTML =  'Uploading in progress . . .'
          }
      })
    </script>
      {% endblock %}
      <title>  Data Upload </title>
  </head>
  <body>
    Welcome to
    {% block upload_button %}
    <input type="file" id="input-file" name='input-file'/>
    <button id="upload-file">Upload File</button>
    <div id="rest"></div>
    <div id="test"></div>
    {% endblock %}
  </body>
</html>

